import os
import glob

# íŒŒì¼ ë¦¬ìŠ¤íŠ¸ë¥¼ ë”•ì…”ë„ˆë¦¬ë¡œ ë³€í™˜
file_list = [
    "2ì‹œë¦¬ì¦ˆ_ê·¸ë€ì¿ í˜_F44_2020_2024_0042.jpg",
    "2ì‹œë¦¬ì¦ˆ_ì•¡í‹°ë¸Œ_íˆ¬ì–´ëŸ¬_U06_2022_2024_0004.jpg",
    "3ì‹œë¦¬ì¦ˆ_F30_2013_2018_0069.jpg",
    "3ì‹œë¦¬ì¦ˆ_F30_2013_2018_0036.jpg",
    "4ì‹œë¦¬ì¦ˆ_F32_2014_2020_0027.jpg",
    "4ì‹œë¦¬ì¦ˆ_G22_2024_2025_0031.jpg",
    "5ì‹œë¦¬ì¦ˆ_G60_2024_2025_0010.jpg",
    "6ì‹œë¦¬ì¦ˆ_GT_G32_2018_2020_0018.jpg",
    "7ì‹œë¦¬ì¦ˆ_F01_2009_2015_0029.jpg",
    "7ì‹œë¦¬ì¦ˆ_F01_2009_2015_0044.jpg",
    "7ì‹œë¦¬ì¦ˆ_G11_2016_2018_0040.jpg",
    "911_992_2020_2024_0006.jpg",
    "911_992_2020_2024_0030.jpg",
    "5008_2ì„¸ëŒ€_2021_2024_0055.jpg",
    "5008_2ì„¸ëŒ€_2021_2024_0051.jpg",
    "A_í´ë˜ìŠ¤_W177_2020_2025_0034.jpg",
    "A8_D5_2018_2023_0084.jpg",
    "CLS_í´ë˜ìŠ¤_C257_2019_2023_0021.jpg",
    "E_í´ë˜ìŠ¤_W212_2010_2016_0069.jpg",
    "ES300h_7ì„¸ëŒ€_2019_2026_0028.jpg",
    "F150_2004_2021_0046.jpg",
    "G_í´ë˜ìŠ¤_W463_2009_2017_0011.jpg",
    "G_í´ë˜ìŠ¤_W463b_2019_2025_0030.jpg",
    "G_í´ë˜ìŠ¤_W463b_2019_2025_0049.jpg",
    "GLB_í´ë˜ìŠ¤_X247_2020_2023_0008.jpg",
    "GLE_í´ë˜ìŠ¤_W167_2019_2024_0068.jpg",
    "GLS_í´ë˜ìŠ¤_X167_2020_2024_0013.jpg",
    "K3_2013_2015_0045.jpg",
    "K5_2ì„¸ëŒ€_2016_2018_0007.jpg",
    "K5_3ì„¸ëŒ€_2020_2023_0081.jpg",
    "Q5_FY_2021_2024_0032.jpg",
    "Q7_4M_2020_2023_0011.jpg",
    "Q30_2017_2019_0074.jpg",
    "Q30_2017_2019_0075.jpg",
    "Q50_2014_2017_0031.jpg",
    "RAV4_5ì„¸ëŒ€_2019_2024_0020.jpg",
    "S_í´ë˜ìŠ¤_W223_2021_2025_0008.jpg",
    "S_í´ë˜ìŠ¤_W223_2021_2025_0071.jpg",
    "SM7_ë‰´ì•„íŠ¸_2008_2011_0053.jpg",
    "X4_F26_2015_2018_0068.jpg",
    "X7_G07_2019_2022_0052.jpg",
    "XF_X260_2016_2020_0023.jpg",
    "ê·¸ëœë“œ_ì²´ë¡œí‚¤_WL_2021_2023_0018.jpg",
    "ê¸€ë˜ë””ì—ì´í„°_JT_2020_2023_0075.jpg",
    "ë‰´_A6_2012_2014_0046.jpg",
    "ë‰´_CC_2012_2016_0002.jpg",
    "ë‰´_ES300h_2013_2015_0000.jpg",
    "ë‰´_ì¹´ì´ì—”_2011_2018_0065.jpg",
    "ë”_ê¸°ì•„_ë ˆì´_EV_2024_2025_0078.jpg",
    "ë”_ë‰´_K3_2ì„¸ëŒ€_2022_2024_0001.jpg",
    "ë”_ë‰´_QM6_2024_2025_0040.jpg",
    "ë”_ë‰´_ê·¸ëœë“œ_ìŠ¤íƒ€ë ‰ìŠ¤_2018_2021_0078.jpg",
    "ë”_ë‰´_ê·¸ëœë“œ_ìŠ¤íƒ€ë ‰ìŠ¤_2018_2021_0079.jpg",
    "ë”_ë‰´_ê·¸ëœë“œ_ìŠ¤íƒ€ë ‰ìŠ¤_2018_2021_0080.jpg",
    "ë”_ë‰´_ìŠ¤íŒŒí¬_2019_2022_0040.jpg",
    "ë”_ë‰´_ì•„ë°˜ë–¼_2014_2016_0031.jpg",
    "ë”_ë‰´_ì½”ë‚˜_2021_2023_0081.jpg",
    "ë”_ë‰´_íŒŒì‚¬íŠ¸_2012_2019_0067.jpg",
    "ë”_ì˜¬ë‰´íˆ¬ì‹¼_í•˜ì´ë¸Œë¦¬ë“œ_2021_2023_0042.jpg",
    "ë””_ì˜¬ë‰´ê·¸ëœì €_2023_2025_0039.jpg",
    "ë¼ë¸Œ4_4ì„¸ëŒ€_2013_2018_0014.jpg",
    "ë¼ë¸Œ4_4ì„¸ëŒ€_2013_2018_0022.jpg",
    "ë ˆë‹ˆê²Œì´ë“œ_2019_2023_0041.jpg",
    "ë ˆì´_2012_2017_0063.jpg",
    "ë ˆì¸ì§€ë¡œë²„_4ì„¸ëŒ€_2018_2022_0048.jpg",
    "ë ˆì¸ì§€ë¡œë²„_5ì„¸ëŒ€_2023_2024_0030.jpg",
    "ë ˆì¸ì§€ë¡œë²„_ìŠ¤í¬ì¸ _2ì„¸ëŒ€_2018_2022_0014.jpg",
    "ë ˆì¸ì§€ë¡œë²„_ìŠ¤í¬ì¸ _2ì„¸ëŒ€_2018_2022_0017.jpg",
    "ë¦¬ì–¼_ë‰´_ì½œë¡œë¼ë„_2021_2022_0067.jpg",
    "ë§ˆì¹¸_2019_2021_0035.jpg",
    "ë¨¸ìŠ¤íƒ±_2015_2023_0086.jpg",
    "ë°•ìŠ¤í„°_718_2017_2024_0011.jpg",
    "ë² ë‰´_2020_2024_0005.jpg",
    "ì‹¼íƒ€í˜_TM_2019_2020_0009.jpg",
    "ì•„ë°˜ë–¼_MD_2011_2014_0009.jpg",
    "ì•„ë°˜ë–¼_MD_2011_2014_0082.jpg",
    "ì•„ë°˜ë–¼_MD_2011_2014_0081.jpg",
    "ì•„ë°˜ë–¼_N_2022_2023_0035.jpg",
    "ì•„ë°˜ë–¼_N_2022_2023_0064.jpg",
    "ì•„ë² ì˜¤_2012_2016_0052.jpg",
    "ìµìŠ¤í”Œë¡œëŸ¬_2016_2017_0072.jpg",
    "ì¹´ì´ì—”_PO536_2019_2023_0035.jpg",
    "ì¹´ì´ì—”_PO536_2019_2023_0054.jpg",
    "ì»¨í‹°ë„¨íƒˆ_GT_3ì„¸ëŒ€_2018_2023_0007.jpg",
    "ì½°íŠ¸ë¡œí¬ë¥´í…Œ_2017_2022_0074.jpg",
    "íƒ€ì´ì¹¸_2021_2025_0003.jpg",
    "íƒ€ì´ì¹¸_2021_2025_0065.jpg",
    "íŒŒë‚˜ë©”ë¼_2010_2016_0000.jpg",
    "íŒŒë‚˜ë©”ë¼_2010_2016_0036.jpg",
    "í”„ë¦¬ìš°ìŠ¤_4ì„¸ëŒ€_2019_2022_0052.jpg",
]

# íŒŒì¼ëª…ì—ì„œ í´ë”ëª…ê³¼ ë²ˆí˜¸ ì¶”ì¶œí•˜ì—¬ ë”•ì…”ë„ˆë¦¬ ìƒì„±
def parse_file_list(file_list):
    files_to_delete = {}
    
    for filename in file_list:
        # íŒŒì¼ëª…ì—ì„œ .jpg ì œê±°
        name_without_ext = filename.replace('.jpg', '')
        
        # ë§ˆì§€ë§‰ '_' ê¸°ì¤€ìœ¼ë¡œ ë¶„ë¦¬í•˜ì—¬ ë²ˆí˜¸ ì¶”ì¶œ
        parts = name_without_ext.split('_')
        number = int(parts[-1])  # ë§ˆì§€ë§‰ ë¶€ë¶„ì´ ë²ˆí˜¸
        folder_name = '_'.join(parts[:-1])  # ë‚˜ë¨¸ì§€ê°€ í´ë”ëª…
        
        if folder_name not in files_to_delete:
            files_to_delete[folder_name] = []
        files_to_delete[folder_name].append(number)
    
    return files_to_delete

# ì‚­ì œí•  íŒŒì¼ ëª©ë¡ ì„¤ì •
files_to_delete = parse_file_list(file_list)

# ê¸°ë³¸ ê²½ë¡œ ì„¤ì • (ì‹¤ì œ ê²½ë¡œë¡œ ìˆ˜ì •í•´ì•¼ í•¨)
base_dir = "/project/ahnailab/jys0207/CP/lexxsh_project_3/hecto/train_final_test"

print("ì‚­ì œí•  íŒŒì¼ ëª©ë¡:")
print("=" * 50)
for folder, numbers in files_to_delete.items():
    print(f"{folder}: {numbers}")
print("=" * 50)

# ì‹¤ì œ ì‚­ì œ ì—¬ë¶€ í™•ì¸
delete_mode = True  # Trueë¡œ ë³€ê²½í•˜ë©´ ì‹¤ì œ ì‚­ì œë©ë‹ˆë‹¤

deleted_count = 0
not_found_count = 0

# ê° í´ë”ì—ì„œ í•´ë‹¹ ë²ˆí˜¸ì˜ íŒŒì¼ ì‚­ì œ
for folder, numbers in files_to_delete.items():
    folder_path = os.path.join(base_dir, folder)
    
    if os.path.exists(folder_path):
        print(f"\nğŸ“ í´ë”: {folder}")
        for number in numbers:
            # íŒŒì¼ëª… íŒ¨í„´ ìƒì„± (ì˜ˆ: GLE_í´ë˜ìŠ¤_W167_2019_2024_0068.jpg)
            file_pattern = f"{folder}_{number:04d}.jpg"
            file_path = os.path.join(folder_path, file_pattern)
            
            # ì •í™•í•œ íŒŒì¼ëª…ìœ¼ë¡œ ë¨¼ì € ì°¾ê¸°
            if os.path.exists(file_path):
                if delete_mode:
                    os.remove(file_path)
                    print(f"  âœ… ì‚­ì œ ì™„ë£Œ: {file_pattern}")
                else:
                    print(f"  ğŸ” ì‚­ì œ ì˜ˆì •: {file_pattern}")
                deleted_count += 1
            else:
                # globì„ ì‚¬ìš©í•˜ì—¬ íŒ¨í„´ì— ë§ëŠ” íŒŒì¼ ì°¾ê¸° (ëŒ€ì†Œë¬¸ì êµ¬ë¶„ ì—†ì´)
                matching_files = glob.glob(os.path.join(folder_path, f"{folder}_*{number:04d}*.jpg"))
                
                if matching_files:
                    for file in matching_files:
                        filename = os.path.basename(file)
                        if delete_mode:
                            os.remove(file)
                            print(f"  âœ… ì‚­ì œ ì™„ë£Œ: {filename}")
                        else:
                            print(f"  ğŸ” ì‚­ì œ ì˜ˆì •: {filename}")
                        deleted_count += 1
                else:
                    print(f"  âŒ íŒŒì¼ì„ ì°¾ì„ ìˆ˜ ì—†ìŒ: {file_pattern}")
                    not_found_count += 1
    else:
        print(f"âŒ í´ë”ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŒ: {folder_path}")
        not_found_count += len(numbers)

print(f"\nğŸ“Š ê²°ê³¼ ìš”ì•½:")
print(f"{'ì‚­ì œ ì™„ë£Œ' if delete_mode else 'ì‚­ì œ ì˜ˆì •'}: {deleted_count}ê°œ")
print(f"ì°¾ì„ ìˆ˜ ì—†ìŒ: {not_found_count}ê°œ")
print(f"ì „ì²´: {len(file_list)}ê°œ")

if not delete_mode:
    print(f"\nâš ï¸  í˜„ì¬ëŠ” ë¯¸ë¦¬ë³´ê¸° ëª¨ë“œì…ë‹ˆë‹¤.")
    print(f"ì‹¤ì œë¡œ ì‚­ì œí•˜ë ¤ë©´ 'delete_mode = True'ë¡œ ë³€ê²½í•˜ì„¸ìš”.")
else:
    print(f"\nâœ… ì‚­ì œ ì‘ì—…ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.")